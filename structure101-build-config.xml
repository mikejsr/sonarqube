<?xml version="1.0" encoding="UTF-8"?>
<headless version="1.0">
    <operations>

        <operation type="check-key-measures">
            <argument name="output-file" value="const(THIS_FILE)/build/structure101/key-measures.xml"/>
            <argument name="output-file-for-snapshot" value="const(THIS_FILE)/build/structure101/snapshot-key-measures.xml"/>
            <argument name="baseline" value="4"/>
            <argument name="fail-on-architecture-violations" value="false"/>
            <argument name="fail-on-fat-package" value="false"/>
            <argument name="fail-on-fat-class" value="false"/>
            <argument name="fail-on-fat-method" value="false"/>
            <argument name="fail-on-feedback-dependencies" value="false"/>
            <argument name="fail-on-spec-violation-dependencies" value="false"/>
            <argument name="fail-on-total-problem-dependencies" value="false"/>
            <argument name="fail-on-spec-item-violations" value="false"/>
            <argument name="fail-on-biggest-class-tangle" value="false"/>
            <argument name="fail-on-tangled-package" value="false"/>
            <argument name="fail-on-architecture-violations" value="false"/>
            <argument name="identifier-on-violation" value="S101 key measure violation"/>
        </operation>
        
        // check for structure spec violations
        <operation type="check-spec">
            <argument name="output-file" value="const(THIS_FILE)/build/structure101/spec-violations.csv"/>
            <argument name="onlyNew" value="false"/>
            <argument name="check-unassociated" value="true"/>
            <argument name="fail-on-violations" value="false"/>
            <argument name="identifier-on-violation" value="build unstable"/>
        </operation>

        // check for xs fat and tangles
        <operation type="check-xs">
            <argument name="output-file" value="const(THIS_FILE)/build/structure101/xs-offenders.xml"/>
            <argument name="fail-on-violations" value="false"/>
            <argument name="fail-on-offenders" value="false"/>
            <argument name="identifier-on-violation" value="build unstable"/>
        </operation>

        // if no exceptions then publish ("fail-on-violations" in the above operations must be true for an exception to be throw)
        <operation type="publish">
            <argument name="label" value="BUILD_LABEL"/>
            <argument name="diagrams" value="true"/>
            <argument name="spec" value="true"/>
            <argument name="actions" value="true"/>
        </operation>

        // once published: -
        // check actions to show those that can't be applied - ie they are already applied or other changes have made them obsolete
        <operation type="check-actions">
            <argument name="output-dir" value="const(THIS_FILE)/build/structure101"/>
        </operation>

        // record metrics for the snapshot/project
        <operation type="report-metrics">
            <argument name="output-file" value="const(THIS_FILE)/build/structure101/report-metrics.xml"/>
        </operation>

        // record summary for the snapshot/project
        <operation type="report-summary">
            <argument name="output-dir" value="const(THIS_FILE)/build/structure101t"/>
            <argument name="xml" value="true"/>
            <argument name="notips" value="true"/>
            <argument name="overwrite" value="true"/>
            <argument name="name" value="EcommerceOFbiz"/>
        </operation>
    </operations>

    <arguments>
        <argument name="local-project" value="const(THIS_FILE)/structure101-settings.java.hsp">
        </argument>
        <argument name="repository" value="http://ubuntu-server:8989/s101j/data"/>
        <argument name="project" value="SonarQube"/>
    </arguments>
</headless>
